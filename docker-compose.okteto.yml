version: "3.9"
services:
    postgres:
        container_name: postgres
        image: postgres
        volumes:
            - pg-data:/var/lib/postgresql/data
        environment:
            POSTGRES_USER: "user"
            POSTGRES_PASSWORD: "pass"
            POSTGRES_DB: "postgres"
        ports:
            - 5435:5432

    rabbitmq:
        container_name: rabbitmq
        image: rabbitmq:3.8.12-management
        ports:
            - 5672:5672
            - 15672:15672

    app:
        build: .
        container_name: app
        image: app
        env_file:
            - .env.remote
        ports:
            - 8080:8080
        depends_on:
            - postgres
            - rabbitmq

volumes:
    pg-data:
